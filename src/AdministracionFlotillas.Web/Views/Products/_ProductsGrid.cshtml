<!-- Filtros -->
<div class="row mb-3 g-3">
    <div class="col-12 col-sm-6 col-md-3">
        <label class="form-label">Categoría</label>
        <ejs-dropdownlist id="filtroCategoria" 
                          placeholder="Todas las categorías"
                          dataSource="@(new string[] { "Categoría 1", "Categoría 2", "Categoría 3" })"
                          change="filtroCategoriaChange">
        </ejs-dropdownlist>
    </div>
    <div class="col-12 col-sm-6 col-md-3">
        <label class="form-label">Estado</label>
        <ejs-dropdownlist id="filtroEstado" 
                          placeholder="Todos los estados"
                          dataSource="@(new string[] { "ACTIVE", "INACTIVE" })"
                          change="filtroEstadoChange">
        </ejs-dropdownlist>
    </div>
    <div class="col-12 col-sm-6 col-md-3">
        <label class="form-label">Precio Mínimo</label>
        <ejs-numerictextbox id="filtroPrecioMin" 
                           placeholder="Desde"
                           format="C2"
                           change="filtroPrecioMinChange">
        </ejs-numerictextbox>
    </div>
    <div class="col-12 col-sm-6 col-md-3">
        <label class="form-label">Precio Máximo</label>
        <ejs-numerictextbox id="filtroPrecioMax" 
                           placeholder="Hasta"
                           format="C2"
                           change="filtroPrecioMaxChange">
        </ejs-numerictextbox>
    </div>
    <div class="col-12 col-sm-6 col-md-3 d-flex align-items-end">
        <button type="button" class="btn btn-secondary w-100" onclick="Products.Filtros.Limpiar()">
            <i class="fas fa-times"></i> Limpiar Filtros
        </button>
    </div>
</div>

<!-- Grid Syncfusion -->
<ejs-grid id="productsGrid" 
          allowPaging="true"
          allowFiltering="true"
          allowSorting="true"
          allowSelection="true"
          allowExcelExport="true"
          allowPdfExport="true"
          allowResizing="true"
          is-responsive="true"
          enable-responsive-row="true"
          toolbarClick="productsGridToolbarClick"
          toolbar="@(new List<string>() { "Search", "ExcelExport", "PdfExport" })"
          rowSelected="productsGridRowSelected"
          actionComplete="productsGridActionComplete"
          dataBound="productsGridDataBound"
          created="productsGridCreated">
    <e-grid-loadingIndicator indicatorType="Shimmer"></e-grid-loadingIndicator>
    <e-grid-pagesettings pageSize="10" pageSizes="@(new int[] { 10, 25, 50, 100 })"></e-grid-pagesettings>
    <e-grid-columns>
        <e-grid-column field="IdProducto" headerText="ID" width="80" isPrimaryKey="true" type="number" textAlign="Right"></e-grid-column>
        <e-grid-column field="NombreProducto" headerText="Nombre" width="200"></e-grid-column>
        <e-grid-column field="Categoria" headerText="Categoría" width="120"></e-grid-column>
        <e-grid-column field="PrecioUnitario" headerText="Precio Unit." width="120" type="number" format="C2" textAlign="Right"></e-grid-column>
        <e-grid-column field="CantidadStock" headerText="Stock" width="100" type="number" textAlign="Right" template="#stockTemplate"></e-grid-column>
        <e-grid-column field="Estado" headerText="Estado" width="120" template="#estadoTemplate"></e-grid-column>
        <e-grid-column field="MargenGanancia" headerText="Margen" width="120" type="number" format="C2" textAlign="Right"></e-grid-column>
        <e-grid-column headerText="Acciones" width="150" template="#accionesTemplate"></e-grid-column>
    </e-grid-columns>
</ejs-grid>

<!-- Template para stock con indicador visual -->
<script id="stockTemplate" type="text/x-template">
    <span class="${if(CantidadStock < 20)}text-danger fw-bold${else if(CantidadStock < 50)}text-warning${else}text-success${/if}">
        ${CantidadStock}
    </span>
</script>

<!-- Template para estado -->
<script id="estadoTemplate" type="text/x-template">
    <span class="badge ${if(Estado === 'ACTIVE')}bg-success${else}bg-secondary${/if}">${Estado}</span>
</script>

<!-- Template para acciones -->
<script id="accionesTemplate" type="text/x-template">
    <div class="d-flex gap-1">
        <button class="btn btn-sm btn-info btn-cabecera-producto" data-id-producto="${IdProducto}" 
                title="Información de Cabecera: ID, Nombre, Categoría, Estado. Información básica e identificadores del producto.">
            <i class="fas fa-id-card"></i> <span class="d-none d-sm-inline">Cabecera</span>
        </button>
        <button class="btn btn-sm btn-success btn-comercial-producto" data-id-producto="${IdProducto}" 
                title="Información Comercial: Precio, Margen, Stock, Métricas de inventario. Datos financieros y de disponibilidad del producto.">
            <i class="fas fa-chart-line"></i> <span class="d-none d-sm-inline">Comercial</span>
        </button>
        <button class="btn btn-sm btn-warning btn-detalles-producto" data-id-producto="${IdProducto}" 
                title="Información de Detalles: Descripción, Especificaciones, Imagen. Datos descriptivos y técnicos del producto.">
            <i class="fas fa-info-circle"></i> <span class="d-none d-sm-inline">Detalles</span>
        </button>
    </div>
</script>
